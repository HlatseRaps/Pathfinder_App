const chapters = [
      {
        title: "1) Course Overview & Mindset",
        kicker: "Why communication is the engine of great hospitality.",
        blocks: [
          {
            h: "Course objectives",
            p: `This course gives you practical tools to make guests feel welcomed, understood, and delighted—while helping you collaborate smoothly with teammates and managers. You’ll learn verbal, non-verbal, written, and digital communication, plus conflict handling and service recovery.`
          },
          {
            h: "Professional hospitality mindset",
            ul: [
              "Curiosity: seek to understand the guest’s real need, not only what they ask for.",
              "Ownership: take responsibility from greeting to resolution—no dead ends.",
              "Clarity: say what you can do and when; confirm next steps.",
              "Warmth: be human and kind, even under pressure.",
              "Consistency: repeat excellence whether the guest is calm or stressed."
            ]
          },
          {
            h: "How to use this course",
            p: `Skim the chapter list, then progress linearly. Each chapter ends with practical takeaways you can test at work. Save your progress to return later.`
          }
        ],
        takeaway: [
          "Communication is a skill you can train daily.",
          "Attitude + clarity + follow-through beat fancy words.",
          "You are the experience, not just the information."
        ]
      },
      {
        title: "2) Foundations of Clear Speaking",
        kicker: "Say it so people get it—first time.",
        blocks: [
          {
            h: "The CPR of clarity",
            ul: [
              "Context: one sentence of setup: “To confirm your room for tonight…”",
              "Point: the core message: “Check-in is from 2 PM, but we can store luggage.”",
              "Request/Resolution: what happens next: “Shall I arrange luggage storage now?”"
            ]
          },
          {
            h: "Tone, pace, and volume",
            p: `Speak slightly slower than natural in busy spaces; keep volume friendly; avoid sounding rushed. A calm tone reduces anxiety and invites trust.`
          },
          {
            h: "Avoiding jargon",
            p: `Replace internal terms (“PAX”, “ADR”, “turns”) with guest-friendly words. If you must use an unfamiliar term, define it in 1 short phrase.`
          }
        ],
        takeaway: [
          "Use CPR: Context → Point → Request.",
          "Slow down a little in noisy or stressful moments.",
          "Translate industry jargon into guest language."
        ]
      },
      {
        title: "3) Active Listening & Questioning",
        kicker: "Listen to understand, not to reply.",
        blocks: [
          {
            h: "Three levels of listening",
            ul: [
              "Level 1: Waiting to speak (most people).",
              "Level 2: Hearing words (information only).",
              "Level 3: Hearing emotions + intent (hospitality gold)."
            ]
          },
          {
            h: "Tools",
            ul: [
              "Mirroring: repeat back key words: “Late arrival at 11 PM, correct?”",
              "Labelling feelings: “It sounds like the flight delay was stressful.”",
              "Open questions: “What’s most important for tonight’s stay?”",
              "Summaries: “So we’ll note quiet room, late arrival, and early checkout.”"
            ]
          },
          {
            h: "Barriers to listening",
            p: `Multitasking, assumptions, and distractions. For critical moments, pause other tasks, make eye contact, and acknowledge before acting.`
          }
        ],
        takeaway: [
          "Reflect back both facts and feelings.",
          "Prefer open questions early, closed questions at confirmation.",
          "Summarize decisions to avoid rework."
        ]
      },
      {
        title: "4) Non-Verbal & Cross-Cultural Signals",
        kicker: "Your body speaks first.",
        blocks: [
          {
            h: "Body language basics",
            ul: [
              "Open posture, gentle smile, and eye contact (adapt to culture).",
              "Nod while summarizing. Keep hands visible; avoid crossed arms.",
              "Angle your body slightly toward the guest—invites conversation."
            ]
          },
          {
            h: "Cultural lenses",
            p: `Different cultures vary on eye contact, directness, personal space, and touch. When unsure, mirror the guest’s comfort level and keep language neutral and respectful.`
          },
          {
            h: "Signals under pressure",
            p: `When it’s busy, your face may show stress. Reset with a breath: relax shoulders, unclench jaw, then re-greet with warmth before speaking.`
          }
        ],
        takeaway: [
          "Let your posture say “I have time for you.”",
          "Mirror guest comfort levels across cultures.",
          "Reset your body before hard conversations."
        ]
      },
      {
        title: "5) Handling Complaints & Service Recovery",
        kicker: "Turn problems into loyalty.",
        blocks: [
          {
            h: "LEARN model",
            ul: [
              "Listen fully (no interruptions).",
              "Empathize: “I’m sorry this happened; I understand why you’re upset.”",
              "Apologize sincerely (own the experience, not blame).",
              "Resolve: propose options; confirm the best one.",
              "Next steps: execute fast; follow up to close the loop."
            ]
          },
          {
            h: "Language that calms",
            p: `Use “can” and “will”: “I can move you to a quiet room and will personally confirm housekeeping timing.” Avoid “policy says…”. Explain the why briefly, then offer what you can do now.`
          },
          {
            h: "Escalation",
            p: `If you can’t fix it immediately, own the handover: introduce the manager by name, summarize the issue in front of the guest, and remain available.`
          }
        ],
        takeaway: [
          "Own the issue end-to-end—even if others help.",
          "Offer choices; confirm the guest’s preference.",
          "Close the loop with a follow-up check."
        ]
      },
      {
        title: "6) Professional Writing: SMS, Email & Chat",
        kicker: "Short, clear, and personable.",
        blocks: [
          {
            h: "Templates that work",
            p: `Use a friendly greeting, one-paragraph answer, bullets for options, and a clear close with name and role.`
          },
          {
            h: "Do / Don’t",
            ul: [
              "Do: subject lines that tell the action needed (“Airport Pickup Confirmation – 8:30 PM”).",
              "Do: short paragraphs, bullet points, and time windows.",
              "Don’t: emoji in formal email; do keep them for chat if brand allows.",
              "Don’t: walls of text—guests are likely on mobile."
            ]
          },
          {
            h: "Proof in 30 seconds",
            p: `Scan for the guest’s key question, check names/dates/times, and ensure there is a clear next step.`
          }
        ],
        takeaway: [
          "One idea per paragraph; bullets for choices.",
          "Concrete details beat polite vagueness.",
          "Always end with “next step + time”."
        ]
      },
      {
        title: "7) Team Communication & Handover",
        kicker: "Shift changes without dropped balls.",
        blocks: [
          {
            h: "Handover checklist",
            ul: [
              "VIPs / special needs today.",
              "Outstanding maintenance or housekeeping requests.",
              "Late arrivals, early checkouts, transport needs.",
              "Complaints in progress and exact status.",
              "Events, groups, and schedule impacts."
            ]
          },
          {
            h: "Channels & cadence",
            p: `Pick a single source of truth (PMS notes, WhatsApp group, shared sheet). Agree on when handovers happen and who owns the update. Consistency prevents “I didn’t know.”`
          },
          {
            h: "Micro-acknowledgements",
            p: `When teammates ask for help, acknowledge quickly (“On it by 14:00”). It reduces anxiety and duplication.`
          }
        ],
        takeaway: [
          "Standardize handovers with a shared checklist.",
          "Write notes as if the night shift will rely on them (because they will).",
          "Acknowledge requests fast—even before you act."
        ]
      },
      {
        title: "8) Persuasion & Upselling with Integrity",
        kicker: "Help guests choose better—without pressure.",
        blocks: [
          {
            h: "The HELP frame",
            ul: [
              "Hear the need (occasion, mood, constraints).",
              "Explain value (benefit > feature).",
              "Link to their context (“Since you’re celebrating…”)",
              "Provide choices (good / better / best) with transparent pricing."
            ]
          },
          {
            h: "Ethical boundaries",
            p: `Never recommend something the guest doesn’t need or can’t use. Long-term trust beats short-term revenue.`
          },
          {
            h: "Language patterns",
            ul: [
              "“Most guests who enjoy __ also loved __ because __.”",
              "“If quiet is priority, I suggest __; if budget, then __.”",
              "“We can prepare that in 15 minutes—shall I book it now?”"
            ]
          }
        ],
        takeaway: [
          "Benefits first; provide honest alternatives.",
          "Anchor to the guest’s purpose, not your quota.",
          "End with a clear, optional next step."
        ]
      },
      {
        title: "9) Communicating Under Pressure",
        kicker: "Calm is contagious.",
        blocks: [
          {
            h: "90-second reset",
            ul: [
              "Box breathing: 4 in, 4 hold, 4 out, 4 hold × 4.",
              "Name the stressor to yourself; name the next action.",
              "Use a bridging phrase with the guest: “Thank you for your patience—here’s what I can do right now.”"
            ]
          },
          {
            h: "Queue language",
            p: `When lines are long, inform and reassure: give realistic wait times, offer alternatives, and circulate with updates. Information reduces frustration.`
          },
          {
            h: "Boundary phrases",
            ul: [
              "“I want to help and I will—here’s what I can do now…”",
              "“I can’t change __, but I can offer __.”",
              "“Let me bring my manager so we resolve this faster together.”"
            ]
          }
        ],
        takeaway: [
          "Regulate yourself first; then the message.",
          "Specific timeframes + visible action = calmer guests.",
          "Boundaries are professional, not rude."
        ]
      },
      {
        title: "10) Putting It All Together",
        kicker: "From theory to daily practice.",
        blocks: [
          {
            h: "Daily 5-minute drills",
            ul: [
              "Rewrite a guest message with CPR structure.",
              "Practice a 3-line apology + resolution.",
              "Role-play one complaint with a colleague (switch roles).",
              "Leave a perfect handover note for one real case."
            ]
          },
          {
            h: "Your personal playbook",
            p: `Capture phrases that feel natural for you. Build 3–5 reusable templates (check-in, late arrival, complaint, upsell, email confirmation).`
          },
          {
            h: "Measuring your impact",
            p: `Watch CSAT/NPS comments, repeat guests, and review keywords (“friendly”, “helpful”, “clear”). Share wins with the team; refine weak spots in next shift meeting.`
          }
        ],
        takeaway: [
          "Small daily reps create big skill jumps.",
          "Standard phrases save time and keep quality high.",
          "Measure feedback; iterate with your team."
        ]
      }
    ];


    // Rendering logic
    const chapterListEl   = document.getElementById("chapterList");
    const chapterTitleEl  = document.getElementById("chapterTitle");
    const chapterKickerEl = document.getElementById("chapterKicker");
    const chapterContentEl= document.getElementById("chapterContent");
    const chapterCountEl  = document.getElementById("chapterCount");
    const progressBarEl   = document.getElementById("progressBar");
    const progressTextEl  = document.getElementById("progressText");

    const btnPrev  = document.getElementById("btnPrev");
    const btnNext  = document.getElementById("btnNext");
    const btnSave  = document.getElementById("btnSave");
    const btnReset = document.getElementById("btnReset");

    const STORAGE_KEY = "pf_comm_skills_progress";
    let current = parseInt(localStorage.getItem(STORAGE_KEY) || "0", 10);
    if (Number.isNaN(current) || current < 0 || current > chapters.length - 1) current = 0;

    // Build chapter list
    function renderChapterList(){
      chapterListEl.innerHTML = "";
      chapters.forEach((ch, idx) => {
        const li = document.createElement("li");
        const btn = document.createElement("button");
        btn.className = "chapter_btn" + (idx === current ? " active" : "");
        btn.innerHTML = `<i class="far fa-file-alt"></i> ${ch.title}`;
        btn.addEventListener("click", () => {
          current = idx;
          renderAll();
        });
        li.appendChild(btn);
        chapterListEl.appendChild(li);
      });
    }

    function renderChapter(){
      const ch = chapters[current];
      chapterTitleEl.textContent  = ch.title;
      chapterKickerEl.textContent = ch.kicker;
      chapterContentEl.innerHTML  = "";

      ch.blocks.forEach(block => {
        const div = document.createElement("div");
        div.className = "panel";
        const h4 = document.createElement("h4");
        h4.textContent = block.h;
        div.appendChild(h4);

        if (block.p){
          const p = document.createElement("p");
          p.textContent = block.p;
          div.appendChild(p);
        }
        if (block.ul){
          const ul = document.createElement("ul");
          block.ul.forEach(item=>{
            const li = document.createElement("li");
            li.textContent = item;
            ul.appendChild(li);
          });
          div.appendChild(ul);
        }
        chapterContentEl.appendChild(div);
      });

      // Key takeaways
      if (ch.takeaway){
        const t = document.createElement("div");
        t.className = "panel";
        const h4 = document.createElement("h4");
        h4.textContent = "Key Takeaways";
        t.appendChild(h4);
        const ul = document.createElement("ul");
        ch.takeaway.forEach(x=>{
          const li = document.createElement("li");
          li.textContent = x;
          ul.appendChild(li);
        });
        t.appendChild(ul);
        chapterContentEl.appendChild(t);
      }

      chapterCountEl.textContent = `Chapter ${current+1} of ${chapters.length}`;
      // enable/disable nav
      btnPrev.disabled = current === 0;
      btnNext.disabled = current === chapters.length - 1;
    }

    function renderProgress(){
      const pct = Math.round(((current+1) / chapters.length) * 100);
      progressBarEl.style.width = pct + "%";
      progressTextEl.textContent = `${pct}% complete`;
    }

    function renderAll(){
      renderChapterList();
      renderChapter();
      renderProgress();
    }

    btnPrev.addEventListener("click", ()=>{
      if (current > 0){
         current--; renderAll();
     }
    });
    btnNext.addEventListener("click", ()=>{
      if (current < chapters.length - 1){
         current++; renderAll(); 
        }
    });
    btnSave.addEventListener("click", ()=>{
      localStorage.setItem(STORAGE_KEY, String(current));
      alert("Progress saved!");
    });
    btnReset.addEventListener("click", ()=>{
      if (confirm("Reset your course progress?")){
        current = 0;
        localStorage.removeItem(STORAGE_KEY);
        renderAll();
      }
    });


    renderAll();